(window.webpackJsonp=window.webpackJsonp||[]).push([["wc.gs"],{556:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return E});var s=n(0),a=n.n(s),r=n(50),o=n.n(r),i=n(83),c=n.n(i),l=n(144),u=n(45),p=n(38),m=n(149),h=n(61),d=n(40),g=n(59),T=n(78),w=n(54),P=n(55),k=n(56),b=n(60),f=n(57),G=n(557),C=n.n(G);const N=["rgba(0, 128, 0, 0.25)"];class E extends s.PureComponent{constructor(e){super(e),this.onReset=(()=>{this.reset(!1)}),this.onInit=(()=>{const{pots:e,currentPotNum:t}=this.state,n=e[t].findIndex(e=>e.host);this.onTeamBallPick(n)}),this.onTeamBallPick=(async e=>{const{pots:t,currentPotNum:n}=this.state,s=t[n],a=s.slice(),r=s.splice(e,1)[0];this.setState({hungPot:a,selectedTeam:r,pickedGroup:null,calculating:!0},this.onTeamSelect)}),this.onTeamSelect=(async()=>{this.setLongCalculating();const{pots:e,groups:t,selectedTeam:n,currentPotNum:s}=this.state;if(!n)throw new Error("no selected team");const a=await this.getPickedGroup();if(void 0===a)return void this.setState({error:"Could not determine the group"});t[a].push(n);const r=e[s].length>0?s:s+1,o=r>=e.length;o&&this.workerWrapper.terminate(),this.state.airborneTeams.push(n);const i=this.animateCell(n,a);this.setState({groups:t,selectedTeam:null,pickedGroup:a,hungPot:e[r],currentPotNum:r,calculating:!1,longCalculating:!1,completed:o,airborneTeams:this.state.airborneTeams},async()=>{await i,this.setState({airborneTeams:this.state.airborneTeams.filter(e=>e!==n)})})}),this.reset(!0),this.onInit()}componentWillUnmount(){this.workerWrapper&&this.workerWrapper.terminate()}reset(e){this.workerWrapper&&this.workerWrapper.terminate();const t=new C.a;this.workerWrapper=new m.a(t,12e4);const n=this.props.pots,s=n.map(e=>u(e)),a=s[0],r={drawId:p("draw-"),initialPots:n,pots:s,groups:a.map(e=>[]),maxTeamsInGroup:s.length,airborneTeams:[],currentPotNum:0,selectedTeam:null,pickedGroup:null,hungPot:a,calculating:!1,longCalculating:!1,completed:!1,error:null};e?this.state=r:this.setState(r,this.onInit)}async getPickedGroup(){try{const{pots:e,groups:t,selectedTeam:n,currentPotNum:s}=this.state,{pickedGroup:a}=await this.workerWrapper.sendAndReceive({pots:e,groups:t,selectedTeam:n,currentPotNum:s});return a}catch(e){console.error(e)}}async setLongCalculating(){const e=l(this.state,"airborneTeams");await o()(3e3);const t=l(this.state,"airborneTeams");c()(t,e)&&this.setState({longCalculating:!0})}animateCell(e,t){const{currentPotNum:n}=this.state;if(!e)return;const s=document.querySelector(`[data-cellid='${e.id}']`),a=`[data-cellid='${Object(d.a)(t)}${n}']`,r=document.querySelector(a);return s instanceof HTMLElement&&r instanceof HTMLElement?Object(h.a)(s,r,350):void 0}render(){const{initialPots:e,pots:t,groups:n,maxTeamsInGroup:s,currentPotNum:r,hungPot:o,airborneTeams:i,selectedTeam:c,pickedGroup:l,calculating:u,longCalculating:p,completed:m}=this.state;return a.a.createElement(f.a,null,a.a.createElement(w.a,null,a.a.createElement(g.a,{selectedTeams:c&&[c],initialPots:e,pots:t,currentPotNum:r}),a.a.createElement(T.a,{maxTeams:s,currentPotNum:r,groups:n,possibleGroups:null,airborneTeams:i,groupColors:N})),a.a.createElement(P.a,null,a.a.createElement(k.a,{calculating:u,completed:m,selectedTeam:c,pot:o,onPick:this.onTeamBallPick}),a.a.createElement(b.a,{long:!0,calculating:p,completed:m,selectedTeam:c,pickedGroup:l,possibleGroups:null,numGroups:n.length,reset:this.onReset})))}}},557:function(e,t,n){e.exports=function(){return new Worker(n.p+"f469287a3cd139e54dff.worker.js")}}}]);